<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Emploi du Temps v2.9 - Application Modulaire</title>

    <!-- BibliothÃ¨ques externes -->
    <script src="lib/jszip.min.js"></script>
    <script src="lib/xlsx.full.min.js"></script>
    <script src="lib/jspdf.umd.min.js"></script>
    <script src="lib/jspdf.plugin.autotable.min.js"></script>

    <!-- Chart.js pour les graphiques du dashboard -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="src/css/main.css">

   
</head>

<body>
    <!-- Spinner de chargement -->
    <div id="loading-overlay" style="display: none;">
        <div class="spinner"></div>
    </div>

    <!-- Zone de notifications -->
    <div id="edt-notification-area"></div>

    <!-- Conteneur principal -->
    <div class="app-container">
        <!-- En-tÃªte -->
        <div id="page-header">
            <div>
                <label for="inputAnneeUniversitaire">AnnÃ©e :</label>
                <input type="text" id="inputAnneeUniversitaire" placeholder="2024/2025">
            </div>
            <div>
                <label for="selectSession">Session :</label>
                <select id="selectSession">
                    <option value="Session d'automne">Session d'automne</option>
                    <option value="Session de printemps">Session de printemps</option>
                </select>
            </div>
            <div>
                <label for="selectDepartement">DÃ©partement :</label>
                <select id="selectDepartement">
                    <option>DÃ©partement de physique</option>
                    <option>DÃ©partement de chimie</option>
                    <option>DÃ©partement de Biologie</option>
                    <option>DÃ©partement de mathÃ©matiques</option>
                    <option>DÃ©partement d'informatique</option>
                    <option>DÃ©partement de GÃ©ologie</option>
                    <option>DÃ©partement Modules Transversaux</option>
                    <option>Administration</option>
                </select>
            </div>
            <div id="header-actions">
                <button id="saveBtn" class="save-btn">ğŸ’¾ Enregistrer</button>
            </div>
        </div>

        <h1>ğŸ§  Gestion Emploi du Temps v2.9 - Modulaire</h1>

        <!-- Navigation par Onglets -->
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="planning">ğŸ“… Planification</button>
            <button class="tab-btn" data-tab="dashboard">ğŸ“Š Dashboard</button>
            <button class="tab-btn" data-tab="config">ğŸ”§ Configuration</button>
            <button class="tab-btn" data-tab="volumes">ğŸ“Š Volumes Horaires</button>
            <button class="tab-btn" data-tab="stats">ğŸ“ˆ Statistiques</button>
            <button class="tab-btn" data-tab="gestion">ğŸ‘¥ Gestion</button>
            <button class="tab-btn" data-tab="salles">ğŸ›ï¸ Gestion Salles</button> <!-- NOUVEAU -->
            <button class="tab-btn" data-tab="souhaits">ğŸ’­ Souhaits Enseignants</button>
            <button class="tab-btn" data-tab="rapports">ğŸ“„ Rapports & Export</button>
        </div>

        <!-- Contenu des Onglets -->

        <!-- ===== ONGLET PLANIFICATION ===== -->
        <div id="tab-planning" class="tab-pane active">
            <h2>ğŸ“… Planification Automatique</h2>

            <!-- Options de planification -->
            <div class="planning-options-panel">
                <h3>âš™ï¸ Options de GÃ©nÃ©ration</h3>
                <label><input type="checkbox" id="optionAssignTeachers" checked> Attribuer automatiquement les
                    enseignants</label>
                <label><input type="checkbox" id="optionAssignRooms" checked> Attribuer automatiquement les
                    salles</label>
                <label><input type="checkbox" id="optionRespectWishes" checked> Respecter les souhaits des
                    enseignants</label>
                <label><input type="checkbox" id="optionAvoidConflicts" checked> Ã‰viter les conflits</label>
            </div>

            <!-- Actions de planification -->
            <div class="planning-actions">
                <button id="btnAutoGenerateAll" class="btn btn-primary">
                    ğŸš€ GÃ©nÃ©rer Toutes les SÃ©ances
                </button>
                <button id="btnOptimizeSchedule" class="btn btn-secondary">
                    âš¡ Optimiser l'EDT
                </button>
                <button id="btnResolveConflicts" class="btn btn-warning">
                    ğŸ”§ RÃ©soudre les Conflits
                </button>
            </div>

            <!-- Filtres et recherche -->
            <div class="search-panel">
                <h3>ğŸ” Filtres et Recherche</h3>
                <div class="search-inputs">
                    <input type="text" id="searchMatiere" placeholder="Filtrer par matiÃ¨re...">
                    <input type="text" id="searchEnseignant" placeholder="Filtrer par enseignant...">
                    <input type="text" id="searchSalle" placeholder="Filtrer par salle...">
                    <input type="text" id="searchSectionGroupe" placeholder="Filtrer par section/groupe...">
                    <button id="btnClearFilters" class="btn btn-sm">ğŸ—‘ï¸ Effacer</button>
                </div>
            </div>

            <!-- SÃ©lecteur de vue -->
            <div class="view-selector">
                <label for="selectEDTView">Vue :</label>
                <select id="selectEDTView">
                    <option value="global">Vue Globale</option>
                    <option value="enseignant_selectionne">Enseignant SÃ©lectionnÃ©</option>
                </select>
            </div>

            <!-- Tableau EDT -->
            <div id="edtTableContainer">
                <table id="edtTable"></table>
            </div>
        </div>
        <!-- ===== ONGLET DASHBOARD ===== -->
        <div id="tab-dashboard" class="tab-pane">
            <div id="dashboardContainer"></div>
        </div>
        <!-- ===== ONGLET CONFIGURATION ===== -->

        <div id="tab-config" class="tab-pane">
            <h2>ğŸ”§ Configuration</h2>

            <!-- Navigation sous-onglets -->
            <div class="sub-tabs-container">
                <button class="sub-tab-btn active" data-subtab="seances">ğŸ“… SÃ©ances</button>
                <button class="sub-tab-btn" data-subtab="matieres">ğŸ“š MatiÃ¨res</button>
                <button class="sub-tab-btn" data-subtab="enseignants">ğŸ‘¨â€ğŸ« Enseignants</button>
                <button class="sub-tab-btn" data-subtab="salles">ğŸ›ï¸ Salles</button>
                <button class="sub-tab-btn" data-subtab="filieres">ğŸ“ FiliÃ¨res</button>
                <button class="sub-tab-btn" data-subtab="forfaits">ğŸ’¼ Forfaits</button>
            </div>

            <!-- ===== SOUS-ONGLET SÃ‰ANCES ===== -->
            <div id="subtab-seances" class="sub-tab-pane active">
                <div class="form-section">
                    <h3>â• Ajouter une SÃ©ance</h3>
                    <form id="formAjouterSeance">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="selectJour">Jour *</label>
                                <select id="selectJour" required></select>
                            </div>
                            <div class="form-group">
                                <label for="selectCreneau">CrÃ©neau *</label>
                                <select id="selectCreneau" required></select>
                            </div>
                            <div class="form-group">
                                <label for="selectFiliere">FiliÃ¨re *</label>
                                <select id="selectFiliere" required></select>
                            </div>
                            <div class="form-group">
                                <label for="selectMatiere">MatiÃ¨re *</label>
                                <select id="selectMatiere" required></select>
                            </div>
                            <div class="form-group">
                                <label for="selectType">Type *</label>
                                <select id="selectType" required></select>
                            </div>
                            <div class="form-group">
                                <label for="selectSection">Section *</label>
                                <select id="selectSection" required></select>
                            </div>
                            <div class="form-group" id="groupeTDTPContainer" style="display: none;">
                                <label for="selectGroupeTDTP">Groupe TD/TP *</label>
                                <select id="selectGroupeTDTP"></select>
                            </div>
                            <div class="form-group">
                                <label for="inputEnseignant1">Enseignant 1</label>
                                <select id="inputEnseignant1"></select>
                            </div>
                            <div class="form-group" id="enseignant2Container" style="display: none;">
                                <label for="inputEnseignant2" id="labelEnseignant2">Enseignant 2
                                    (Co-responsable)</label>
                                <select id="inputEnseignant2"></select>
                            </div>
                            <div class="form-group">
                                <label for="selectSalle">Salle</label>
                                <select id="selectSalle"></select>
                            </div>
                        </div>

                        <div id="matiereInfoDisplay" style="margin-top: 15px;"></div>

                        <!-- AperÃ§u des souhaits de l'enseignant sÃ©lectionnÃ© (si prÃ©sent) -->
                        <div id="teacherWishesPreview" style="margin-top: 12px;"></div>

                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button type="submit" id="btnAjouterSeance" class="btn btn-primary">â• Ajouter la
                                SÃ©ance</button>
                            <button type="button" id="btnCancelSeanceEdit" class="btn btn-secondary"
                                style="display: none;">âŒ Annuler</button>
                            <button type="button" id="btnResetSeanceForm" class="btn btn-secondary">ğŸ”„
                                RÃ©initialiser</button>
                        </div>
                    </form>
                </div>
                <div class="form-section">
                    <h3>âš™ï¸ RÃ©glages GÃ©nÃ©raux</h3>
                    <div id="configGeneralSettingsContainer"></div>
                </div>
            </div>

            <!-- ===== SOUS-ONGLET MATIÃˆRES ===== -->
            <div id="subtab-matieres" class="sub-tab-pane">
                <!-- Formulaire Ajouter MatiÃ¨re -->
                <div class="form-section">
                    <h3>â• Ajouter une MatiÃ¨re</h3>
                    <form id="formAjouterMatiere">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputNomMatiere">Nom de la matiÃ¨re *</label>
                                <input type="text" id="inputNomMatiere" required placeholder="Ex: MÃ©canique Quantique">
                            </div>
                            <div class="form-group">
                                <label for="selectFiliereMatiere">FiliÃ¨re *</label>
                                <select id="selectFiliereMatiere" required></select>
                            </div>
                            <div class="form-group">
                                <label for="selectDepartementMatiere">DÃ©partement</label>
                                <select id="selectDepartementMatiere">
                                    <option value="">-- SÃ©lectionner --</option>
                                    <!-- Rempli dynamiquement par populateFormSelects() -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="inputSectionsCours">Sections *</label>
                                <input type="number" id="inputSectionsCours" min="0" value="1" required>
                            </div>
                            <div class="form-group">
                                <label for="inputTDGroups">Groupes TD *</label>
                                <input type="number" id="inputTDGroups" min="0" value="0" required>
                            </div>
                            <div class="form-group">
                                <label for="inputTPGroups">Groupes TP *</label>
                                <input type="number" id="inputTPGroups" min="0" value="0" required>
                            </div>
                            <div class="form-group">
                                <label for="inputVolumeCoursHTP">Volume hTP Cours *</label>
                                <input type="number" id="inputVolumeCoursHTP" min="0" value="48" required>
                            </div>
                            <div class="form-group">
                                <label for="inputVolumeTDHTP">Volume hTP TD *</label>
                                <input type="number" id="inputVolumeTDHTP" min="0" value="32" required>
                            </div>
                            <div class="form-group">
                                <label for="inputVolumeTPHTP">Volume hTP TP *</label>
                                <input type="number" id="inputVolumeTPHTP" min="0" value="36" required>
                            </div>
                            <div class="form-group">
                                <label for="inputNbEnseignantsTP">Nb Enseignants TP *</label>
                                <input type="number" id="inputNbEnseignantsTP" min="1" value="1" required>
                            </div>
                        </div>

                        <div id="vhtPreview" style="margin-top: 15px;"></div>

                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn btn-primary">â• Ajouter la MatiÃ¨re</button>
                        </div>
                    </form>
                </div>

                <!-- Liste des MatiÃ¨res -->
                <div class="form-section">
                    <h3>ğŸ“š MatiÃ¨res EnregistrÃ©es</h3>
                    <div id="configMatieresListContainer"></div>
                </div>
            </div>

            <!-- ===== SOUS-ONGLET ENSEIGNANTS ===== -->
            <div id="subtab-enseignants" class="sub-tab-pane">
                <!-- Formulaire Ajouter Enseignant -->
                <div class="form-section">
                    <h3>â• Ajouter un Enseignant</h3>
                    <form id="formAjouterEnseignant">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputNomEnseignant">Nom de l'enseignant *</label>
                                <input type="text" id="inputNomEnseignant" required placeholder="Ex: Dr. Ahmed Bennani">
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn btn-primary">â• Ajouter l'Enseignant</button>
                        </div>
                    </form>
                </div>

                <!-- Liste des Enseignants -->
                <div class="form-section">
                    <h3>ğŸ‘¨â€ğŸ« Enseignants EnregistrÃ©s</h3>
                    <div id="configEnseignantsListContainer"></div>
                </div>
            </div>

            <!-- ===== SOUS-ONGLET SALLES ===== -->
            <div id="subtab-salles" class="sub-tab-pane">
                <!-- Formulaire Ajouter Salle -->
                <div class="form-section">
                    <h3>â• Ajouter une Salle</h3>
                    <form id="formAjouterSalle">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputNomSalle">Nom de la salle *</label>
                                <input type="text" id="inputNomSalle" required placeholder="Ex: S1">
                            </div>
                            <div class="form-group">
                                <label for="selectTypeSalle">Type de salle *</label>
                                <select id="selectTypeSalle" required></select>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn btn-primary">â• Ajouter la Salle</button>
                        </div>
                    </form>
                </div>

                <!-- Liste des Salles -->
                <div class="form-section">
                    <h3>ğŸ›ï¸ Salles EnregistrÃ©es</h3>
                    <div id="configSallesListContainer"></div>
                </div>
                <div class="config-section">
                    <h3 class="config-title">Salles SpÃ©cifiques par FiliÃ¨re</h3>
                    <p class="config-description">
                        DÃ©finissez un "pool" de salles prioritaires pour les "Cours" ou "TD".
                        La planification auto les utilisera en prioritÃ©.
                        (Utilisez <strong>CTRL+Clic</strong> ou <strong>CMD+Clic</strong> pour en sÃ©lectionner
                        plusieurs).
                    </p>

                    <div id="configSallesParFiliereContainer" class="config-list">
                    </div>
                </div>
            </div>

            <!-- ===== SOUS-ONGLET FILIÃˆRES ===== -->
            <div id="subtab-filieres" class="sub-tab-pane">
                <!-- Formulaire Ajouter FiliÃ¨re -->
                <div class="form-section">
                    <h3>â• Ajouter une FiliÃ¨re</h3>
                    <form id="formAjouterFiliere">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputNomFiliere">Nom de la filiÃ¨re *</label>
                                <input type="text" id="inputNomFiliere" required placeholder="Ex: S5 P">
                            </div>
                            <div class="form-group">
                                <label for="selectSessionFiliere">Session *</label>
                                <select id="selectSessionFiliere" required></select>
                                <label for="selectDepartementFiliere">DÃ©partement *</label>
                                <select id="selectDepartementFiliere" required>
                                    <option value="">-- SÃ©lectionner --</option>
                                    <!-- Les options seront remplies dynamiquement par populateFormSelects -->
                                </select>
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button type="submit" class="btn btn-primary">â• Ajouter la FiliÃ¨re</button>
                        </div>
                    </form>
                </div>

                <!-- Liste des FiliÃ¨res -->
                <div class="form-section">
                    <h3>ğŸ“ FiliÃ¨res EnregistrÃ©es</h3>
                    <div id="configFilieresListContainer"></div>
                </div>
            </div>


            <!-- ===== SOUS-ONGLET FORFAITS ===== -->
            <div id="subtab-forfaits" class="sub-tab-pane">
                <!-- Formulaire Ajouter Forfait -->
                <div class="form-section">
                    <h3>â• Ajouter un Forfait</h3>
                    <form id="formAjouterForfait">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="selectEnseignantForfait">Enseignant *</label>
                                <select id="selectEnseignantForfait" required>
                                    <option value="">-- SÃ©lectionner un enseignant --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="selectNatureForfait">Nature du forfait *</label>
                                <select id="selectNatureForfait" required>
                                    <option value="">-- SÃ©lectionner --</option>
                                    <option value="Chef de dÃ©partement">Chef de dÃ©partement</option>
                                    <option value="CollÃ¨ge">CollÃ¨ge</option>
                                    <option value="Master">Master</option>
                                    <option value="Coordonnateur de filiÃ¨re">Coordonnateur de filiÃ¨re</option>
                                    <option value="Autres">Autres</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="inputVolumeHoraireForfait">Volume horaire (h) *</label>
                                <input type="number" id="inputVolumeHoraireForfait" min="0" step="0.5" required
                                    placeholder="Ex: 50">
                            </div>
                            <div class="form-group">
                                <label for="inputDescriptionForfait">Description</label>
                                <input type="text" id="inputDescriptionForfait" placeholder="Description optionnelle">
                            </div>
                        </div>
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button type="submit" id="btnAjouterForfait" class="btn btn-primary">â• Ajouter le
                                Forfait</button>
                            <button type="button" id="btnCancelForfaitEdit" class="btn btn-secondary"
                                style="display: none;">âŒ Annuler</button>
                            <button type="button" id="btnResetForfaitForm" class="btn btn-secondary">ğŸ”„
                                RÃ©initialiser</button>
                        </div>
                    </form>
                </div>

                <!-- Liste des Forfaits -->
                <div class="form-section">
                    <h3>ğŸ’¼ Forfaits EnregistrÃ©s</h3>
                    <div id="forfaitsListContainer"></div>
                </div>
            </div>

        </div>


        <!-- ===== ONGLET VOLUMES ===== -->
        <div id="tab-volumes" class="tab-pane">
            <h2>ğŸ“Š Volumes Horaires</h2>
            <div id="volumesContainer"></div>
        </div>
        <!-- ===== ONGLET STATISTIQUES ===== -->
        <div id="tab-stats" class="tab-pane">
            <h2>ğŸ“ˆ Statistiques</h2>
            <div id="statsContainer"></div>
        </div>

        <!-- ===== ONGLET GESTION ===== -->
        <div id="tab-gestion" class="tab-pane">
            <h2>ğŸ‘¥ Gestion des Ressources</h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                <!-- Liste Enseignants -->
                <div class="form-section">
                    <div id="teachersListContainer"></div>
                </div>

                <!-- Liste MatiÃ¨res -->
                <div class="form-section">
                    <div id="subjectsListContainer"></div>
                </div>

                <!-- Liste Salles -->
                <div class="form-section">
                    <div id="roomsListContainer"></div>
                </div>
            </div>
        </div>
        <!-- ===== ONGLET GESTION SALLES ===== -->
        <div id="tab-salles" class="tab-pane">
            <div id="roomManagementContainer"></div>
        </div>

        <!-- ===== ONGLET SOUHAITS ENSEIGNANTS ===== -->
        <div id="tab-souhaits" class="tab-pane">
            <h2>ğŸ’­ Gestion des Souhaits des Enseignants</h2>

            <!-- Import Souhaits -->
            <div class="form-section">
                <h3>ğŸ“¥ Importer les Souhaits depuis Excel</h3>
                <p style="margin-bottom: 15px; color: #6c757d;">
                    Importez les souhaits de vos enseignants depuis un fichier Excel.
                    Le fichier doit contenir les colonnes : Enseignant, Choix1, C1, TD1, TP1, Choix2, C2, TD2, TP2,
                    Choix3, C3, TD3, TP3, Contraintes.
                </p>

                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                    <button id="btnImportWishesMain" class="btn btn-primary">ğŸ“¥ Importer Souhaits (Excel)</button>
                    <button id="btnDownloadWishesTemplateMain" class="btn btn-secondary">ğŸ“‹ TÃ©lÃ©charger Template
                        Excel</button>
                    <input type="file" id="fileImportWishesMain" accept=".xlsx,.xls" style="display: none;">
                </div>

                <!-- Instructions -->
                <div
                    style="background: #e7f3ff; border-left: 4px solid #2196F3; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                    <h4 style="margin-top: 0; color: #1976D2;">ğŸ“– Instructions</h4>
                    <ol style="margin: 0; padding-left: 20px;">
                        <li>TÃ©lÃ©chargez le template Excel en cliquant sur "TÃ©lÃ©charger Template Excel"</li>
                        <li>Remplissez le fichier avec les souhaits de chaque enseignant</li>
                        <li>Pour chaque choix, indiquez le nombre de sÃ©ances souhaitÃ©es (0 = refus, vide = flexible)
                        </li>
                        <li>Cliquez sur "Importer Souhaits" et sÃ©lectionnez votre fichier rempli</li>
                    </ol>
                </div>

                <!-- Format attendu -->
                <div style="background: #fff9e6; border-left: 4px solid #FFC107; padding: 15px; border-radius: 4px;">
                    <h4 style="margin-top: 0; color: #F57C00;">ğŸ“‹ Format du Fichier Excel</h4>
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.85em;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="border: 1px solid #dee2e6; padding: 8px;">Enseignant</th>
                                <th style="border: 1px solid #dee2e6; padding: 8px;">Choix 1</th>
                                <th style="border: 1px solid #dee2e6; padding: 8px;">C1</th>
                                <th style="border: 1px solid #dee2e6; padding: 8px;">TD1</th>
                                <th style="border: 1px solid #dee2e6; padding: 8px;">TP1</th>
                                <th style="border: 1px solid #dee2e6; padding: 8px;">...</th>
                                <th style="border: 1px solid #dee2e6; padding: 8px;">Contraintes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">Dr. Ahmed Bennani</td>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">MÃ©canique Quantique</td>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">1</td>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">2</td>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">0</td>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">...</td>
                                <td style="border: 1px solid #dee2e6; padding: 8px;">Disponible le matin</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Liste des Souhaits Actuels -->
            <div class="form-section">
                <h3>ğŸ‘¥ Souhaits Actuels des Enseignants</h3>
                <div id="wishesListContainer">
                    <p class="empty-message">Chargement des souhaits...</p>
                </div>
            </div>

            <!-- Formulaire de Saisie Manuel -->
            <div class="form-section">
                <h3>âœï¸ Saisir/Modifier les Souhaits Manuellement</h3>
                <form id="formSouhaitsEnseignant">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="selectEnseignantSouhaits">Enseignant *</label>
                            <select id="selectEnseignantSouhaits" required>
                                <option value="">-- SÃ©lectionner un enseignant --</option>
                            </select>
                        </div>
                    </div>

                    <!-- Choix 1 -->
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 20px;">
                        <h4 style="margin-top: 0;">1er Choix</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputChoix1">MatiÃ¨re</label>
                                <select id="inputChoix1">
                                    <option value="">-- SÃ©lectionner --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="inputC1">Nb Cours</label>
                                <input type="number" id="inputC1" min="0" placeholder="0 = refus">
                            </div>
                            <div class="form-group">
                                <label for="inputTD1">Nb TD</label>
                                <input type="number" id="inputTD1" min="0" placeholder="0 = refus">
                            </div>
                            <div class="form-group">
                                <label for="inputTP1">Nb TP</label>
                                <input type="number" id="inputTP1" min="0" placeholder="0 = refus">
                            </div>
                        </div>
                    </div>

                    <!-- Choix 2 -->
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <h4 style="margin-top: 0;">2Ã¨me Choix</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputChoix2">MatiÃ¨re</label>
                                <select id="inputChoix2">
                                    <option value="">-- SÃ©lectionner --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="inputC2">Nb Cours</label>
                                <input type="number" id="inputC2" min="0" placeholder="0 = refus">
                            </div>
                            <div class="form-group">
                                <label for="inputTD2">Nb TD</label>
                                <input type="number" id="inputTD2" min="0" placeholder="0 = refus">
                            </div>
                            <div class="form-group">
                                <label for="inputTP2">Nb TP</label>
                                <input type="number" id="inputTP2" min="0" placeholder="0 = refus">
                            </div>
                        </div>
                    </div>

                    <!-- Choix 3 -->
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <h4 style="margin-top: 0;">3Ã¨me Choix</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="inputChoix3">MatiÃ¨re</label>
                                <select id="inputChoix3">
                                    <option value="">-- SÃ©lectionner --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="inputC3">Nb Cours</label>
                                <input type="number" id="inputC3" min="0" placeholder="0 = refus">
                            </div>
                            <div class="form-group">
                                <label for="inputTD3">Nb TD</label>
                                <input type="number" id="inputTD3" min="0" placeholder="0 = refus">
                            </div>
                            <div class="form-group">
                                <label for="inputTP3">Nb TP</label>
                                <input type="number" id="inputTP3" min="0" placeholder="0 = refus">
                            </div>
                        </div>
                    </div>

                    <!-- Contraintes -->
                    <div class="form-group" style="margin-top: 15px;">
                        <label for="inputContraintes">Contraintes et Remarques</label>
                        <textarea id="inputContraintes" rows="3"
                            placeholder="Ex: Disponible uniquement le matin, PrÃ©fÃ¨re les TD aux TP..."></textarea>
                    </div>

                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn btn-primary">ğŸ’¾ Enregistrer les Souhaits</button>
                        <button type="button" id="btnResetWishesForm" class="btn btn-secondary">ğŸ”„
                            RÃ©initialiser</button>
                    </div>
                </form>
            </div>
        </div>
        <!-- ===== ONGLET RAPPORTS ===== -->
        <div id="tab-rapports" class="tab-pane">
            <h2>ğŸ“„ Rapports & Export</h2>

            <!-- Export EDT -->
            <div class="export-section">
                <h3>ğŸ“¥ Export de l'Emploi du Temps</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="btnExportPDF" class="btn btn-primary">ğŸ“„ Exporter en PDF</button>
                    <button id="btnExportExcel" class="btn btn-success">ğŸ“— Exporter en Excel</button>
                    <button id="btnExportTeachersSchedules" class="btn btn-info">ğŸ‘¨â€ğŸ« EDT Enseignants (PDF)</button>
                </div>
            </div>

            <!-- Export Volumes -->
            <div class="export-section">
                <h3>ğŸ“Š Export des Volumes Horaires</h3>
                <button id="btnExportVolumes" class="btn btn-info">ğŸ“Š Exporter Volumes (Excel)</button>
            </div>

            <!-- Import -->
            <div class="import-section">
                <h3>ğŸ“¥ Imports</h3>

                <div class="import-group">
                    <h4>Souhaits des Enseignants</h4>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button id="btnImportWishes" class="btn btn-secondary">ğŸ“¥ Importer Souhaits (Excel)</button>
                        <button id="btnDownloadWishesTemplate" class="btn btn-sm">ğŸ“‹ TÃ©lÃ©charger Template</button>
                    </div>
                    <input type="file" id="fileImportWishes" accept=".xlsx,.xls" style="display: none;">
                </div>

                <div class="import-group">
                    <h4>MatiÃ¨res</h4>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button id="btnImportSubjects" class="btn btn-secondary">ğŸ“¥ Importer MatiÃ¨res (Excel)</button>
                        <button id="btnDownloadSubjectsTemplate" class="btn btn-sm">ğŸ“‹ TÃ©lÃ©charger Template</button>
                    </div>
                    <input type="file" id="fileImportSubjects" accept=".xlsx,.xls" style="display: none;">
                </div>
            </div>

            <!-- Gestion Projet -->
            <div class="export-section">
                <h3>ğŸ’¾ Gestion du Projet</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="btnExportProject" class="btn btn-primary">ğŸ“¤ Exporter Projet (JSON)</button>
                    <button id="btnImportProject" class="btn btn-secondary">ğŸ“¥ Importer Projet (JSON)</button>
                    <input type="file" id="fileImportProject" accept=".json" style="display: none;">
                </div>
                <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="btnResetEDT" class="btn btn-warning">ğŸ”„ RÃ©initialiser EDT Session</button>
                    <button id="btnResetProject" class="btn btn-danger">âš ï¸ RÃ©initialiser Projet Complet</button>
                </div>
            </div>

            <!-- Journal des opÃ©rations -->
            <div id="log-container" class="form-section">
                <h3>ğŸ“‹ Journal des OpÃ©rations
                    <button id="btnClearLog" class="btn btn-sm btn-danger" style="float: right;">ğŸ—‘ï¸ Vider</button>
                </h3>
                <div id="messages"></div>
            </div>
        </div>

        <!-- Footer -->
        <footer id="page-footer">
            Pr. Ibrahim Mrani - UCD - Version 2.9 Modulaire - DÃ©veloppÃ© par @mranii-cmd - 2025-11-04
        </footer>
    </div>

    <!-- Modale de dialogue -->
    <div id="dialogModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md"
            style="background: white; border-radius: 12px; padding: 30px; max-width: 500px; width: 90%;">
            <div class="flex justify-between items-center border-b pb-3 mb-4"
                style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #e9ecef; padding-bottom: 15px; margin-bottom: 20px;">
                <h3 id="dialogTitle" class="text-xl font-bold" style="font-size: 1.3em; font-weight: bold;">Notification
                </h3>
                <button id="closeDialogBtn" class="text-gray-500 hover:text-gray-800 text-2xl leading-none"
                    style="background: none; border: none; font-size: 1.5em; cursor: pointer;">&times;</button>
            </div>
            <div id="dialogBody" class="text-gray-700 mb-6" style="margin-bottom: 20px; line-height: 1.6;"></div>
            <div class="flex justify-end gap-4" style="display: flex; justify-content: flex-end; gap: 10px;">
                <button id="dialogCancelBtn" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
                    style="padding: 10px 20px; background: #e9ecef; border: none; border-radius: 6px; cursor: pointer;">Annuler</button>
                <button id="dialogConfirmBtn" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
                    style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer;">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Application principale (ES6 Module) -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>
    <script type="module" src="src/js/main.js"></script>
</body>

</html>